<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
        <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.9/dist/umd/popper.min.js"></script> -->
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <link
            href="https://fonts.googleapis.com/css2?family=Barlow:wght@300&family=Cormorant+Garamond:wght@300&family=Dancing+Script&family=Inter:wght@300;400&family=Lora:ital,wght@1,600&family=Open+Sans:wght@300&family=Oswald&family=Poppins:wght@300&family=Quicksand:wght@300&family=Ysabeau:ital,wght@1,100&display=swap"
            rel="stylesheet">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Vast+Shadow&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@500&family=Vast+Shadow&display=swap"
            rel="stylesheet">
        <style>
            /* Updated styling with background color and increased text size */
         .typing-text1 {
                margin: 0;
                height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                background-color: #000000;
                text-align: justify;
                color: #c4124d;


        } 

            html {
                overflow-y: hidden;
            }

            #typing-text {
                /* font-family: monospace; */
                font-family: 'Lora', serif;
                white-space: pre-wrap;
                /* Allow text to wrap to the next line */
                overflow: hidden;
                border-right: 1px solid #000;
                font-size: 50px;
                /* Increase text size */
                padding: 10px;
                /* Add padding for better visibility */
            }
            #hidediv {
            display: none;
        }
        </style>
    </head>

    <body>

        <!-- Create a container for the typing effect -->
        {% if val == 0 %}

    </body>


        <!-- <p id="currentTime"></p>
        <ul id="scheduledTimes"></ul>
        <div id="hidediv">
            <form id="myForm" action="display1" method="post"> -->
                <!-- Your form fields go here -->
                <!-- <label for="username">time:</label>
                <input type="text" id="tm" name="tm" required>
                <input type="text" id="day" name="day" required>
                <input type="submit" value="Submit">
            </form>
        </div> -->
        <!-- {% csrf_token %} -->
        <h1 id="timeDisplay"></h1>
        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel" data-interval="4000">
            <div class="carousel-inner">
        
                <!-- 2nd Year -->
                <div class="carousel-item active">
                    <h1>2nd Year</h1>
                    {% if val1 is not 0 %}
                    <table class="table table-bordered">
                        <thead class="thead-dark">
                            <tr>
                                <th>Section</th>
                                <th>Subject</th>
                                <th>Teacher</th>
                            </tr>
                        </thead>
                        {% for i in lst1 %}
                        <tr>
                            <td>{{i.0}}</td>
                            <td>{{i.1}}</td>
                            <td>{{i.2}}</td>
                        </tr>
                        {% endfor %}
                    </table>
                    {% else %}
                    <h1>NO CLASSWORK</h1>
                    {% endif %}
                </div>
        
                <!-- 3rd Year -->
                <div class="carousel-item">
                    <h1>3rd Year</h1>
                    {% if val2 is not 0 %}
                    <table class="table table-bordered">
                        <thead class="thead-dark">
                            <tr>
                                <th>Section</th>
                                <th>Subject</th>
                                <th>Teacher</th>
                            </tr>
                        </thead>
                        {% for i in lst2 %}
                        <tr>
                            <td>{{i.0}}</td>
                            <td>{{i.1}}</td>
                            <td>{{i.2}}</td>
                        </tr>
                        {% endfor %}
                    </table>
                    {% else %}
                    <h1>NO CLASSWORK</h1>
                    {% endif %}
                </div>
        
                <!-- 4th Year -->
                <div class="carousel-item">
                    <h1>4th Year</h1>
                    {% if val3 is not 0 %}
                    <table class="table table-bordered">
                        <thead class="thead-dark">
                            <tr>
                                <th>Section</th>
                                <th>Subject</th>
                                <th>Teacher</th>
                            </tr>
                        </thead>
                        {% for i in lst3 %}
                        <tr>
                            <td>{{i.0}}</td>
                            <td>{{i.1}}</td>
                            <td>{{i.2}}</td>
                        </tr>
                        {% endfor %}
                    </table>
                    {% else %}
                    <h1>NO CLASSWORK</h1>
                    {% endif %}
                </div>
        
            </div>
        
            <!-- Add navigation arrows if needed -->
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        
        <!-- Include Bootstrap JS and jQuery -->
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        

        <script>
            function updateTime() {
                const now = new Date();
                const day = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                const time = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                const hours = now.getHours();
                const minutes = now.getMinutes();
                const seconds = now.getSeconds();
    
                const isLunchTime = hours >= 13 && hours < 14;
    
                let displayText = `<h1>${day}</h1><h1>${time}</h1>`;
    
                if (isLunchTime) {
                    displayText += `<h1><b>It's lunchtime!</b></h1>`;
                }
    
                document.getElementById('timeDisplay').innerHTML = displayText;
            }
            function refreshPage() {
                location.reload(true); // true forces a reload from the server, not from the cache
            }

  // Set an interval to call the refreshPage function every 2 minutes (120,000 milliseconds)
            setInterval(refreshPage, 120000);
            setInterval(updateTime, 1000); // Update every second
            updateTime(); // Update immediately on page load
        </script>

        <!-- <script>
            // Given list of time intervals
            var timeIntervals = ["9:30-10:30", "10:30-11:20", "11:20-12:10", "12:10-13:00", "14:00-14:50", "14:50-15:40", "15:40-16:30"];

            // Function to check if the current time is within the given list
            function getCurrentScheduledTime() {
                // Get the current time
                var currentTime = new Date();

                // Format the current time
                var currentHours = currentTime.getHours();
                var currentMinutes = currentTime.getMinutes();
                var formattedCurrentTime = currentHours + ":" + currentMinutes;

                // Check if the current time is in the list of scheduled times
                for (var i = 0; i < timeIntervals.length; i++) {
                    var [startTime, endTime] = timeIntervals[i].split('-');
                    if (startTime <= formattedCurrentTime && formattedCurrentTime <= endTime) {
                        return timeIntervals[i];
                    }
                }

                // Return null if the current time is not within any scheduled time
                return null;
            }

            // Function to update the time
            function updateCurrentTime() {
                // Get the current time
                var currentTime = new Date();

                // Format the time (adjust the format as needed)
                var hours = currentTime.getHours();
                var minutes = currentTime.getMinutes();
                var seconds = currentTime.getSeconds();
                var currentDayNumber = currentTime.getDay();

                // Create an array of days
                var daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

                // Get the current day name
                var currentDayName = daysOfWeek[currentDayNumber];

                console.log("Current day number:", currentDayNumber);
                console.log("Current day name:", currentDayName);
                // Add leading zeros if necessary
                hours = (hours < 10) ? '0' + hours : hours;
                minutes = (minutes < 10) ? '0' + minutes : minutes;
                seconds = (seconds < 10) ? '0' + seconds : seconds;

                // Display the formatted time in the HTML element with id="currentTime"
                document.getElementById("currentTime").innerHTML = hours + ":" + minutes + ":" + seconds;

                // Check if the current time is within the scheduled times
                var currentScheduledTime = getCurrentScheduledTime();

                // Display the result
                if (currentScheduledTime !== null) {
                    var tm = document.getElementById("tm");
                    tm.setAttribute('value', currentScheduledTime);
                    tm.setAttribute('placeholder', currentScheduledTime);
                    var dy = document.getElementById("day");
                    dy.setAttribute('value', currentDayNumber);
                    dy.setAttribute('placeholder', currentDayNumber);
                    //dy.setAttribute('value', "6");
                    document.getElementById("scheduledTimes").innerHTML = "<li>Current scheduled time: " + currentScheduledTime + "</li>";
                } else {
                    document.getElementById("scheduledTimes").innerHTML = "<li>Current time is not within any scheduled time.</li>";
                }
            }



            //Function to submit the form
            function submitForm() {
                updateCurrentTime();
                document.getElementById('myForm').submit();
            }

            setInterval(submitForm, 10000);
            // Set up a timer to submit the form every 2 minutes (120000 milliseconds)

        </script> -->




        {% elif val == 1 %}
        <div class="typing-text1"><div id="typing-text"></div></div>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.9/dist/umd/popper.min.js"></script>
        
        <script>
            // JavaScript to create typing effect
            const textToType = "{{data}}";
            let index = 0;
            const speed = 50; // Adjust the speed in milliseconds

            function typeText() {
                document.getElementById('typing-text').textContent += textToType.charAt(index);
                index++;

                if (index < textToType.length) {
                    setTimeout(typeText, speed);
                }
                else {
                    refreshTimeout = setTimeout(refreshPage, 3000);
                }
            }
            function changeTextColor() {
            const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet'];
            const textElement = document.getElementById('typing-text');

            // Calculate a random index within the colors array bounds
            const randomIndex = Math.floor(Math.random() * colors.length);
            const newColor = colors[randomIndex];

            // Set the text color and display a log message in the console
            textElement.style.color = newColor;
            console.log("Text color changed to:", newColor);
        }

            // Start the typing effect when the page loads
            window.onload = function () {
                typeText();
                changeTextColor();
            };
        </script>
        {% elif val == 2 %}
        <div class="typing-text1">
        <div id="carouselExample" class="carousel slide mt-2" data-ride="carousel" data-interval="5000">
            <div class="carousel-inner p-5">
                {% for i in imgs %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <img src="{{ i.image.url }}" style="width: 100vh; height: 100vh; object-fit: cover;"
                        class="d-block w-100" alt="Slide {{ forloop.counter }}">

                    <div class="carousel-caption">
                        <h3 style="color: white; font-family: 'Roboto Slab', serif;">{{ i.text }}</h3>
                    </div>
                </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#carouselExample" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExample" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        <script>
           
            $(document).ready(function () {
                $('#carouselExample').on('slid.bs.carousel', function () {
                    var currentIndex = $(this).find('.active').index();
                    var totalItems = $(this).find('.carousel-item').length;

                    // Check if the next slide is the first one (wrap around)
                    if (currentIndex === totalItems - 1) {
                        // Reload the page
                        refreshTimeout = setTimeout(refreshPage, 4000);
                        console.log(refreshTimeout);
                    }
                });
            });
            
        </script>
        
        </div>
        

        {% elif val == 3 %}
        {% for video in videos %}
        <video autoplay muted style="width: 100%; height:100%; object-fit: cover;">
            <source src="{{ video.video_file.url }}" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        {% endfor %}
        <script>
            var video = document.querySelector('video');
            var refreshTimeout;

            video.addEventListener('ended', function () {
                console.log("$$$$$$$$");
                // Video has ended, start the refresh timer
                refreshTimeout = setTimeout(refreshPage, 3000);
            });

            video.addEventListener('play', function () {
                clearTimeout(refreshTimeout);
            });
            setTimeout(function () {
                if (video.ended) {
                    refreshPage();
                }
            }, 3000);
        </script>
        {% elif val == 4 %}

        
        {% for pdf in pdfs %}
        <div id="pdf-viewer"></div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.8.335/pdf.min.js"></script>
        <script>
            // URL to your PDF file
            var pdfUrl = '{{ pdf.pdf_file.url }}';

            // PDF.js worker from the built/ folder
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.8.335/pdf.worker.min.js';

            // Asynchronously download PDF as an ArrayBuffer
            var loadingTask = pdfjsLib.getDocument(pdfUrl);
            loadingTask.promise.then(function (pdf) {
                // Get the number of pages in the PDF
                var numPages = pdf.numPages;

                // Iterate through all pages
                for (var pageNum = 1; pageNum <= numPages; pageNum++) {
                    // Fetch the page
                    pdf.getPage(pageNum).then(function (page) {
                        var scale = 2.5;
                        var viewport = page.getViewport({ scale: scale });

                        // Prepare canvas using PDF page dimensions
                        var canvas = document.createElement('canvas');
                        var context = canvas.getContext('2d');
                        canvas.height = viewport.height;
                        canvas.width = viewport.width;

                        // Render PDF page into canvas context
                        var renderContext = {
                            canvasContext: context,
                            viewport: viewport
                        };
                        page.render(renderContext).promise.then(function () {
                            // Display canvas in div
                            document.getElementById('pdf-viewer').appendChild(canvas);

                            // If this is the last page, scroll to the bottom
                            if (pageNum === numPages) {
                                window.scrollTo(0, document.body.scrollHeight);
                            }
                        });
                    });
                }
            }, function (reason) {
                // PDF loading error
                console.error(reason);
            });
        </script>
        <script>
            function scrollPageDownSlowly() {
                // Get the total height of the webpage
                var totalHeight = Math.max(
                    document.body.scrollHeight,
                    document.body.offsetHeight,
                    document.documentElement.clientHeight,
                    document.documentElement.scrollHeight,
                    document.documentElement.offsetHeight
                );

                // Get the current scroll position
                var currentPosition = window.scrollY || document.documentElement.scrollTop;

                // Set the target scroll position to the bottom of the page
                var targetPosition = totalHeight;

                // Calculate the distance to scroll in small steps
                var distance = targetPosition - currentPosition;

                // Set the duration of the scroll animation (in milliseconds)
                var duration = 1000000; // 1 second

                // Calculate the number of frames based on the duration
                var frames = 5000; // 60 frames per second

                // Calculate the interval between each frame
                var interval = duration / frames;

                // Calculate the distance to scroll in each frame
                var step = distance / frames;

                // Function to perform the scrolling animation
                function scrollStep() {
                    currentPosition += step;

                    // Scroll to the new position
                    window.scrollTo(0, currentPosition);

                    // Check if the animation is complete
                    if (currentPosition < targetPosition) {
                        // Continue scrolling on the next frame
                        requestAnimationFrame(scrollStep);
                    } else {
                        // Animation is complete, refresh the page
                        location.reload();
                    }
                }

                // Start the scrolling animation
                scrollStep();
            }

            // Call the function when the page is loaded
            window.onload = function () {
                // You can trigger the scroll when a button is clicked or any other event
                // For example, let's trigger it after 3 seconds for demonstration purposes
                setTimeout(scrollPageDownSlowly, 3000);
            };
        </script>

        {% endfor %}


        {% endif %}

        <script>
            // Function to refresh the page
            function refreshPage() {
                location.reload(true); // true forces a reload from the server, not from the cache
            }
        </script>
    </body>

</html>