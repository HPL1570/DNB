<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Current Time</title>
    <style>
        #hidediv {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>

<body>
    <p id="currentTime"></p>
    <ul id="scheduledTimes"></ul>
    <div id="hidediv">
        <form id="myForm" action="displayTimeTable" method="post">
            <!-- Your form fields go here -->
            {% csrf_token %}
            <label for="username">time:</label>
            <input type="text" id="tm" name="tm" required>
            <input type="text" id="day" name="day" required>
            <input type="submit" value="Submit">
        </form>
    </div>
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">

            <!-- 2nd Year -->
            <div class="carousel-item active">
                <h1>2nd Year</h1>
                <table class="table table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th>Section</th>
                            <th>Subject</th>
                            <th>Teacher</th>
                        </tr>
                    </thead>
                    {% for i in lst1 %}
                    <tr>
                        <td>{{i.1.1}}</td>
                        <td>{{i.0.0}}</td>
                        <td>{{i.0.1}}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>

            <!-- 3rd Year -->
            <div class="carousel-item">
                <h1>3rd Year</h1>
                <table class="table table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th>Section</th>
                            <th>Subject</th>
                            <th>Teacher</th>
                        </tr>
                    </thead>
                    {% for i in lst2 %}
                    <tr>
                        <td>{{i.1.1}}</td>
                        <td>{{i.0.0}}</td>
                        <td>{{i.0.1}}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>

            <!-- 4th Year -->
            <div class="carousel-item">
                <h1>4th Year</h1>
                <table class="table table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th>Section</th>
                            <th>Subject</th>
                            <th>Teacher</th>
                        </tr>
                    </thead>
                    {% for i in lst3 %}
                    <tr>
                        <td>{{i.1.1}}</td>
                        <td>{{i.0.0}}</td>
                        <td>{{i.0.1}}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>

        </div>

        <!-- Add navigation arrows if needed -->
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>

    <!-- Include Bootstrap JS and jQuery -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>


    <script>
        // Given list of time intervals
        var timeIntervals = ["9:30-10:30", "10:30-11:20", "11:20-12:10", "12:10-13:00", "14:00-14:50", "14:50-15:40", "15:40-16:30"];

        // Function to check if the current time is within the given list
        function getCurrentScheduledTime() {
            // Get the current time
            var currentTime = new Date();

            // Format the current time
            var currentHours = currentTime.getHours();
            var currentMinutes = currentTime.getMinutes();
            var formattedCurrentTime = currentHours + ":" + currentMinutes;

            // Check if the current time is in the list of scheduled times
            for (var i = 0; i < timeIntervals.length; i++) {
                var [startTime, endTime] = timeIntervals[i].split('-');
                if (startTime <= formattedCurrentTime && formattedCurrentTime <= endTime) {
                    return timeIntervals[i];
                }
            }

            // Return null if the current time is not within any scheduled time
            return null;
        }

        // Function to update the time
        function updateCurrentTime() {
            // Get the current time
            var currentTime = new Date();

            // Format the time (adjust the format as needed)
            var hours = currentTime.getHours();
            var minutes = currentTime.getMinutes();
            var seconds = currentTime.getSeconds();
            var currentDayNumber = currentTime.getDay();

            // Create an array of days
            var daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

            // Get the current day name
            var currentDayName = daysOfWeek[currentDayNumber];

            console.log("Current day number:", currentDayNumber);
            console.log("Current day name:", currentDayName);
            // Add leading zeros if necessary
            hours = (hours < 10) ? '0' + hours : hours;
            minutes = (minutes < 10) ? '0' + minutes : minutes;
            seconds = (seconds < 10) ? '0' + seconds : seconds;

            // Display the formatted time in the HTML element with id="currentTime"
            document.getElementById("currentTime").innerHTML = hours + ":" + minutes + ":" + seconds;

            // Check if the current time is within the scheduled times
            var currentScheduledTime = getCurrentScheduledTime();

            // Display the result
            if (currentScheduledTime !== null) {
                var tm = document.getElementById("tm");
                tm.setAttribute('value', currentScheduledTime);
                tm.setAttribute('placeholder', currentScheduledTime);
                var dy = document.getElementById("day");
                dy.setAttribute('value', currentDayNumber);
                dy.setAttribute('placeholder', currentDayNumber);
                //dy.setAttribute('value', "6");
                document.getElementById("scheduledTimes").innerHTML = "<li>Current scheduled time: " + currentScheduledTime + "</li>";
            } else {
                document.getElementById("scheduledTimes").innerHTML = "<li>Current time is not within any scheduled time.</li>";
            }
        }



        //Function to submit the form
        function submitForm() {
            updateCurrentTime();
            document.getElementById('myForm').submit();
        }

        setInterval(submitForm, 60000);
        // Set up a timer to submit the form every 2 minutes (120000 milliseconds)

    </script>
</body>

</html>